<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>用户管理</title>
    <link href="https://unpkg.com/amis@6.0.0/sdk/sdk.css" rel="stylesheet" />
    <link href="https://unpkg.com/amis@6.0.0/sdk/helper.css" rel="stylesheet" />
    <link href="https://unpkg.com/amis@6.0.0/sdk/iconfont.css" rel="stylesheet" />
    <script src="https://unpkg.com/amis@6.0.0/sdk/sdk.js"></script>
    <style> html, body, #root { height: 100%; margin: 0; } </style>
</head>
<body>
<div id="root"></div>

<script>
    (function () {
        const amis = amisRequire('amis/embed');

        const schema = {
            type: "page",
            title: "用户管理",
            body: {
                type: "crud",
                api: {
                    method: "post",
                    url: "/api/user/list",
                    data: {
                        page: "$page",
                        perPage: "$perPage"
                    },
                    responseData: {
                        items: [
                            { id: 1, name: "张三", phone: "13800138000", org: "技术部", gender: "男", role: "管理员", password: "******" },
                            { id: 2, name: "李四", phone: "13800138001", org: "财务部", gender: "女", role: "普通用户", password: "******" }
                        ],
                        total: 2
                    }
                },
                columns: [
                    { name: "name", label: "姓名", type: "text" },
                    { name: "phone", label: "电话", type: "text" },
                    { name: "org", label: "单位", type: "text" },
                    { name: "gender", label: "性别", type: "text" },
                    { name: "role", label: "角色", type: "text" },
                    { name: "password", label: "密码", type: "text" },
                    {
                        type: "operation",
                        label: "操作",
                        buttons: [
                            {
                                type: "button",
                                label: "编辑",
                                actionType: "dialog",
                                level: "link",
                                dialog: {
                                    title: "编辑用户",
                                    body: {
                                        type: "form",
                                        api: {
                                            method: "post",
                                            url: "/api/mock/user/update"
                                        },
                                        controls: [
                                            { type: "hidden", name: "id" },
                                            { type: "text", name: "name", label: "姓名", required: true },
                                            { type: "text", name: "phone", label: "电话", required: true },
                                            { type: "text", name: "org", label: "单位" },
                                            {
                                                type: "select",
                                                name: "gender",
                                                label: "性别",
                                                options: [
                                                    { label: "男", value: "男" },
                                                    { label: "女", value: "女" }
                                                ]
                                            },
                                            {
                                                type: "select",
                                                name: "role",
                                                label: "角色",
                                                options: [
                                                    { label: "管理员", value: "管理员" },
                                                    { label: "普通用户", value: "普通用户" },
                                                    { label: "访客", value: "访客" }
                                                ]
                                            },
                                            { type: "password", name: "password", label: "密码" }
                                        ]
                                    }
                                }
                            },
                            {
                                type: "button",
                                label: "删除",
                                actionType: "ajax",
                                level: "link",
                                confirmText: "确定要删除该用户吗？",
                                api: {
                                    method: "post",
                                    url: "/api/user/delete"
                                }
                            }
                        ]
                    }
                ],
                toolbar: [
                    {
                        type: "button",
                        label: "新增用户",
                        actionType: "dialog",
                        level: "primary",
                        dialog: {
                            title: "新增用户",
                            body: {
                                type: "form",
                                api: {
                                    method: "post",
                                    url: "/api/user/create"
                                },
                                controls: [
                                    { type: "text", name: "name", label: "姓名", required: true },
                                    { type: "text", name: "phone", label: "电话", required: true },
                                    { type: "text", name: "org", label: "单位" },
                                    {
                                        type: "select",
                                        name: "gender",
                                        label: "性别",
                                        options: [
                                            { label: "男", value: "男" },
                                            { label: "女", value: "女" }
                                        ]
                                    },
                                    {
                                        type: "select",
                                        name: "role",
                                        label: "角色",
                                        options: [
                                            { label: "管理员", value: "管理员" },
                                            { label: "普通用户", value: "普通用户" },
                                            { label: "访客", value: "访客" }
                                        ]
                                    },
                                    { type: "password", name: "password", label: "密码", required: true }
                                ]
                            }
                        }
                    }
                ]
            }
        };

        amis.embed('#root', schema);
    })();
</script>
</body>
</html>
